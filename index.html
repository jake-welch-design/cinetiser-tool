<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinetiser Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
</head>

<body>
    <header> <a href="https://jakewelch.design" target="_blank" id="websiteLink">jakewelch.design</a>
        <h1 id="main-title">Cinetiser Tool</h1>
    </header>


    <!-- Main layout container with two flex sections -->
    <div id="main-container">
        <!-- GUI Section (Left) -->
        <div id="gui-section" class="main-section">
            <!-- Sidebar GUI Panel -->
            <div id="gui-panel">
                <!-- Close button (X) in top-right of GUI -->
                <button id="gui-close" class="gui-close-btn">Ã—</button>

                <div class="gui-content">
                    <!-- Image Upload Section -->
                    <div class="gui-section">
                        <h3 class="gui-section-header">Upload Image</h3>
                        <input type="file" id="imageInput" accept="image/*">
                    </div>

                    <!-- Parameter Controls Section -->
                    <div class="gui-section" id="controls-section">
                        <!-- Controls will be dynamically generated from config -->
                    </div>

                    <!-- Cut Buttons Grid (placed here, will be populated by GUI) -->
                    <div id="cuts-grid" class="cuts-grid">
                        <!-- Cut buttons will be generated here -->
                    </div>

                    <!-- Action Buttons -->
                    <div class="gui-section">
                        <button id="resetBtn">Reset</button>
                        <button id="saveBtn">Save</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Canvas Section (Right) -->
        <div id="canvas-section" class="main-section">
            <div id="canvas-container"></div>
        </div>
    </div>

    <!-- GUI Toggle Button (after gui-section so sibling selector works) -->
    <button id="gui-toggle" class="gui-toggle-btn">Open Settings</button>

    <!-- p5.js library -->

    <!-- Load modules after p5.js is ready -->
    <script type="module">
        // Clear file inputs on page load to prevent caching
        window.addEventListener('load', () => {
            const fileInputs = document.querySelectorAll('input[type="file"]');
            fileInputs.forEach(input => {
                input.value = '';
            });
        });

        // Wait for p5.js to be fully loaded
        window.addEventListener('load', async () => {
            // Import modules - gui-generator first, then gui.js will listen for the event
            await import('./gui-generator.js');
            await import('./gui.js');
            await import('./sketch.js');
        });
    </script>
</body>

</html>