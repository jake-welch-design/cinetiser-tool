<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cinetiser Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
</head>

<body>
    <header> <a href="https://jakewelch.design" target="_blank" id="websiteLink">jakewelch.design</a>
        <h1 id="main-title">Cinetiser Tool</h1>
    </header>
    <!-- Canvas container -->
    <div id="canvas-container"></div>

    <!-- GUI Toggle Button -->
    <button id="gui-toggle" class="gui-toggle-btn">Open Settings</button>

    <!-- Sidebar GUI Panel -->
    <div id="gui-panel">
        <!-- Close button (X) in top-right of GUI -->
        <button id="gui-close" class="gui-close-btn">Ã—</button>

        <div class="gui-content">

            <!-- <div class="gui-section">
                <p style="font-size: 0.9em; margin-top: -5px; margin-bottom: -5px; color: #cacaca;">
                    Upload an image and adjust parameters below. Click 'Save' to export.
                </p>
            </div> -->

            <!-- Image Upload Section -->
            <div class="gui-section">
                <h3 class="gui-section-header">Upload Image</h3>
                <input type="file" id="imageInput" accept="image/*">
            </div>

            <!-- Parameter Controls Section -->
            <div class="gui-section" id="controls-section">
                <!-- Controls will be dynamically generated from config -->
            </div>

            <!-- Action Buttons -->
            <div class="gui-section">
                <button id="saveBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- p5.js library -->

    <!-- Load modules after p5.js is ready -->
    <script type="module">
        // Clear file inputs on page load to prevent caching
        window.addEventListener('load', () => {
            const fileInputs = document.querySelectorAll('input[type="file"]');
            fileInputs.forEach(input => {
                input.value = '';
            });
        });

        // Wait for p5.js to be fully loaded
        window.addEventListener('load', async () => {
            // Import modules - gui-generator first, then gui.js will listen for the event
            await import('./gui-generator.js');
            await import('./gui.js');
            await import('./sketch.js');
        });
    </script>
</body>

</html>